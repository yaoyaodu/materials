# IP核

更详细信息参见：[科普：芯片行业所说的IP是个什么东西？-面包板社区 (eet-china.com)](https://www.eet-china.com/mp/a61226.html)

要点：

- 芯片行业中所说的IP，也称为IP核(Intellectual Property Core)。IP核是指芯片中**具有独立功能的电路模块的成熟设计**。

- 在电路模块设计的三个不同阶段，可以得到的不同类型的IP核，分别称为**IP软核、IP固核和IP硬核**。由软化到固化，再到硬化，IP核的可配置性和灵活性变小，但完善性提高，复用风险性降低。

- 一般说来，**一个复杂的芯片是由芯片设计者自主设计的电路部分和多个外购的IP核连接构成的**。芯片设计公司购买IP厂商的IP核，通过IP复用可以快速设计出功能复杂的芯片，可以节约设计时间，提高芯片设计成功率。

- IP开发和IP复用技术大大促进了芯片设计业的快速发展。

  

## IP核概念

芯片行业中所说的IP，一般也称为IP核。**IP核是指芯片中具有独立功能的电路模块的成熟设计。**该电路模块设计可以应用在包含该电路模块的其他芯片设计项目中，从而**减少设计工作量，缩短设计周期，提高芯片设计的成功率**。该电路模块的成熟设计凝聚着设计者的智慧，体现了设计者的知识产权，因此，芯片行业就用IP核 (Intellectual Property Core)来表示这种电路模块的成熟设计。IP核也可以理解为**芯片设计的中间构件**。

一般说来，**一个复杂的芯片是由芯片设计者自主设计的电路部分和多个外购的IP核连接构成的**。如下图所示，要设计这样结构的一款芯片，设计公司可以外购芯片中所有的IP核(不同颜色模块)，仅设计芯片中自己有创意的、自主设计的部分(用绿色表示)，并把各部分连接起来。

<figure align="center"><img src="https://i.loli.net/2021/08/25/6mvfD1IEKt3pea7.jpg"></img><figcaption>图 自主设计部分和多个IP核集成在一起，形成复杂芯片的设计</figcaption></figure>

上图的芯片设计过程就像下图的系统电路板开发过程一样，是**用已有的、成熟的IP核(或者芯片)进行布局、摆放和信号连接的过程，这种过程可以称为对IP核(或者芯片)的复用**。不同的是，系统电路板上除了芯片和连接线之外，系统开发者很少自主开发自己的芯片。而在芯片设计过程中，芯片上除了采用外购的IP核之外，一般说来，芯片设计者还要设计一部分自己的电路，并完成各部分之间的信号连线，最后还要对整个芯片的功能、性能进行制造前的反复检查和验证。

<figure align="center"><img src="https://i.loli.net/2021/08/25/28hma3FpedfP6bI.jpg"></img><figcaption>图 由IP核搭建复杂芯片，与用芯片搭建完整的系统电路板类似</figcaption></figure>

## IP作用

IP的作用主要有四个方面：

* 使芯片设计化繁为简，缩短芯片设计周期，提高复杂芯片设计的成功率。
* IP开发和IP复用技术使小公司设计大芯片成为可能。
* 使系统整机企业可以设计自己的芯片，提升自主创新能力和整机系统的自主知识产权含量。
* 使芯片设计行业摆脱传统IDM模式，成为产业链上独立的行业，促进了芯片设计业迅猛发展。

目前，许多中小微芯片设计公司虽然设计能力和水平有限，但出于抢占市场，缩短芯片设计周期的需要，会外购许多IP核来完成自己的芯片设计项目。业界的IP开发商、IP提供商数量不断增加，也变得越来越专业。各种功能、各种类型的IP核不断涌现。IP交易活动也日趋普遍，交易金额也越来越大。

说明：[IDM、Fabless 和 Foundry：半导体芯片行业的三种运作模式 (trantion.net)](https://www.trantion.net/h-nd-245.html)

IDM（Integrated Device Manufacture）模式主要的特点是**集芯片设计、芯片制造、芯片封装和测试等多个产业链环节于一身**。早期多数集成电路企业采用的模式，目前仅有极少数企业能够维持。代表企业：三星、德州仪器（TI）。

 主要的优势：设计、制造等环节协同优化，有助于充分发掘技术潜力；能有条件率先实验并推行新的半导体技术（如 FinFet）。

主要的劣势：公司规模庞大，管理成本较高；运营费用较高，资本回报率偏低。



## IP种类

IP核有**行为(Behavior)级、结构(Structure)级和物理(Physical)级**三个层次的分类，对应着三个种类型的IP核：

* IP软核：由**硬件描述语言** (HDL)设计的软核 (Soft IP Core)
* IP固核：完成**结构描述**的固核 (Firm IP Core)
* IP硬核：基于**物理描述并经过工艺验证**的硬核 (Hard IP Core)

<img src="https://i.loli.net/2021/09/03/JyplhtPWO8xKCf9.png" alt="image-20210903105218221" style="zoom:50%;" />

**1. IP软核**：它是用硬件描述语言(HDL)设计的独立功能的电路模块。从芯片设计程度来看，它只经过了**RTL级设计优化和功能验证**，通常是**以HDL文本形式提交给用户**。所以它不包含任何物理实现信息，因此，IP软核与制造工艺无关。

用户购买了IP软核后，可以综合出正确的**门电路级设计网表**，并可以进行后续的**结构设计**，具有很大的灵活性。借助于EDA综合工具，用户可以很容易与其它IP软核，以及自主设计的电路部分合成一体，并根据各种不同半导体工艺，设计成具有不同性能的芯片。

**2. IP固核**：它的设计程度介于IP软核和IP硬核之间，它除了完成IP软核所有的设计外，还完成了**门级电路综合和时序仿真**等设计环节。一般地，它**以门级电路网表的形式提供给用户**。

**3. IP硬核**：它提供了电路设计最后阶段**掩模级的电路模块**。它以最终完成的**布局布线网表形式提供给用户**。IP硬核既具有结果的可预见性，也可以针对特定工艺或特定IP提供商进行功耗和尺寸的优化。

<img src="https://i.loli.net/2021/09/03/Zzq2SCbdAH57OGQ.png" alt="查看源图像" style="zoom: 33%;" />

所以，三种类型的IP核是**电路功能模块设计在不同设计阶段的产物**，如下图所示。

![img](https://i.loli.net/2021/09/02/4JQeGz8hD7WEwBZ.jpg)

<center><b>图5 在电路功能模块设计的不同阶段，可得到不同类型的IP核</b></center>

用户经过精心评测和选择，购买了IP厂商的IP核后，开始设计自己的芯片。前文讲过，一个复杂芯片一般由购买的IP核和用户自主设计的电路部分组成。芯片设计过程包括了**行为级**、**结构级**和**物理级**三个阶段。

* **行为级和结构级**设计阶段的工作一般称为**前端设计**。
* **物理级**设计阶段的工作一般称为**后端设计**。

下图意图说明，不同类型的IP核是在不同的设计阶段中加入到整个芯片设计中去。

![img](https://i.loli.net/2021/09/02/DkL2KmOxT57JijX.jpg)

<center><b>三种类型的IP核在芯片设计不同阶段被合并到设计中，形成了一个整体</b></center>



三种类型的IP核各有优缺点，用户会根据自己的实际需要来选择。

**IP软核**：它以**综合源代码**的形式交付给用户，其优点是源代码灵活，在功能一级可以重新配置，可以灵活选择目标制造工艺。灵活性高、可移植性强，允许用户自配置。其缺点是对电路功能模块的预测性较差，在后续设计中存在发生错误的可能性，有一定的设计风险。并且IP软核的知识产权保护难度较大。

**IP固核**：它的灵活性和成功率介于IP软核和IP硬核之间，是一种折中的类型。和IP软核相比，IP固核的设计灵活性稍差，但在可靠性上有较大提高。**目前，IP固核是IP核的主流形式之一。**

**IP硬核**：它的最大优点是确保性能，如速度、功耗等达到预期效果。然而，IP硬核与制造工艺相关，难以转移到新的工艺或者集成到新的结构中去，是不可以重新配置的。IP硬核不许修改的特点使其复用有一定的困难，因此只能用于某些特定应用，使用范围较窄。但IP硬核的知识产权保护最为方便。



IP核的举例，最典型有**ARM公司的各种类型的CPU IP核**。许多IP供应商提供的DSP IP核、USB IP核、PCI-X IP核、WiFi IP核、以太网IP核、嵌入式存储器IP核等，五花八门，品种十分繁多。如果按大类分，大体上可分为：

* 处理器和微控制器类IP
* 存储器类IP
* 外设及接口类IP
* 模拟和混合电路类IP
* 通信类IP
* 图像和媒体类IP

全球大的EDA供应商中，有些也是IP供应商。例如美国新思科技(Synopsys)可提供上千种各类IP。涵盖逻辑电路(Logic Libraries)、嵌入式存储器(Embedded Memories)、模拟电路(Analog Libraries)、有线和无线通信接口(Wired and Wireless Interface)、安全(Security)、嵌入式处理器(Embedded Processors) 和子系统(Subsystems)等方面的IP。



## IP开发

IP核开发与芯片设计过程比较相似，都需要紧跟芯片技术的发展趋势，不断积累芯片设计技术，了解芯片制造工艺发展步伐。所不同的是：

* 芯片设计公司的商业模式是设计完整的芯片，并推向市场，实现芯片销售利润。

* IP开发商不设计完整的芯片，他们**只设计芯片局部的某些功能模块**，**追求这些功能模块(IP核)的设计是最优化的，并要实现IP核在多种复用场合的适应性、便利化**。

  IP开发商谋求这些IP可以被众多芯片设计公司购买采用，并实现IP的销售利润。

但是，**IP开发的技术难度和要求很高**，并不是任何芯片设计公司想为即可为的事情。这主要体现在：

* 一是**IP的完备性要求**。IP核作为芯片设计的构件，可以与软件设计的构件(中间件)作比较。软件构件中可以隐藏小瑕疵，集成后的系统软件还可以在投入实际应用时，通过打补丁升级的方式不断完善。**但IP核必须非常完善，一点瑕疵都不能有。**因为，IP核的任何小瑕疵都有可能影响到整个复杂芯片设计的成败，影响到花费了数百万元甚至上亿元整个芯片研发的投入产出。因此，复杂IP核的售价极为昂贵，从数十万元到上百万元不等。为了便于推广，IP厂商一般采用收取前期**IP许可费(IP License)**+后期按芯片出货量计算的<b>版权费(Royalty)</b>的商业模式，以降低用户的研发投入。
* 二是**IP的多参数需求**，包括工艺节点、电源、功耗、性能等。这些都要求IP开发者对芯片设计、制造工艺和行业应用等非常熟悉。
* 三是**用户对IP提供商的信誉度要求，包括公司技术实力、影响力和稳定度等**。用户很难接受一家规模较小，发展不稳定的IP厂商提供的IP，哪怕这些IP很便宜，甚至免费。用户宁愿购买著名的、大的IP厂商提供的较贵的IP，因为这样的IP才有质量保障和后续服务的保障。

2000年以来，在国发18号文件和八个国家级IC设计产业化基地的促进下，国内IC设计企业如雨后春笋般涌现，并得到快速发展。这些企业大部分是中小微IC设计企业，**得益于IP开发和IP复用技术，这些中小IC设计企业都可以根据市场需要，及时开发出各种功能的系统级芯片(SOC)、人工智能(AI)芯片、物联网(IoT)芯片等。**这些推动了国内IC设计业的高速发展，带动了我国新一代信息技术产业的发展。可以说，**晶圆代工技术、IP开发和IP复用技术成就了我国目前芯片产业的快速发展基础。**

 

