# 嵌入式系统

嵌入式系统分为四层：

- 硬件层
- 驱动层
- 操作系统层
- 应用层



嵌入式软件：embedded software

嵌入式软件就是**嵌入在硬件中的操作系统和开发工具软件**，它在产业中的关联关系体现为：芯片设计制造→嵌入式系统软件→嵌入式电子设备开发、制造。
嵌入式软件与嵌入式系统是密不可分的，嵌入式系统一般由嵌入式微处理器、外围硬件设备、嵌入式操作系统以及用户的应用程序4个部分组成，用于实现对其他设备的控制、监视或管理等功能。
嵌入式软件就是基于嵌入式系统设计的软件，**它也是计算机软件的一种，同样由程序及其文档组成**，是嵌入式系统的重要组成部分。



嵌入式系统中代码的执行方式主要有三种：

- 完全映射（fully shadowed）：嵌入式系统程序运行时，将所有的代码从非易失存储器（Flash、ROM等）复制到RAM中运行。

- 按需分页（demand paging）：只复制部分代码到RAM中。这种方法对RAM中的页进行导入/导出管理，如果访问位于虚存中但不在物理RAM中会产生页错误，这时才将代码和数据映射到RAM中。

- eXecute In Place (XIP)：即芯片内执行，在系统启动时，不将代码复制到RAM，而是直接在非易失性存储位置执行。**RAM中只存放需要不断变化的数据部分**，如图1所示。

  重点：片内执行**不是说程序在存储器内执行**，CPU的基本功能就是取指、译码和执行。NOR Flash能在芯片内执行，就是指**CPU的取指模块能够直接从NOR Flash中把指令取出来**，供后面的译码和执行模块使用。

如果非易失性存储器的读取速度与RAM相近，则**XIP可以节省复制和解压的时间**。

NOR Flash和ROM的**读取速度**比较快（约100 ns），**适合XIP**。

NAND Flash的**读操作**是基于扇区的，速度相对很慢(μs级)，因此不宜实现XIP系统。而NAND闪存**写入速度**比NOR快，更适合**SND（存储和下载）系统**。

![img](https://i.loli.net/2021/07/30/jO2SxLwqRUhHaXe.png)



![XIP片内执行](https://i.loli.net/2021/07/30/lzTNUoaqKbyrp6m.png)





