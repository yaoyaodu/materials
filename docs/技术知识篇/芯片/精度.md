# 精度

![image-20220818104839190](C:\Users\杜瑶瑶\AppData\Roaming\Typora\typora-user-images\image-20220818104839190.png)

**浮点数：小数的二进制表示法**

IEEE 浮点算术标准是用来衡量计算机上以二进制所表示数字精度的通用约定。

- 双精度（double precision）：64位浮点数
- 单精度（single precision）：32位浮点数
- 半精度（half precision）：16位浮点数

**在双精度格式中，每个数字占用64位，单精度格式占用32位，而半精度仅16位。**

半精度是英伟达在2002年搞出来的。

- 双精度和单精度：为了**计算**。
- 半精度：更多为了**降低数据传输和存储成本**。

IEEE 754 标准指定了一个binary16要有如下的格式：

- **Sign bit（符号位）**： 1 bit
- **Exponent** width（**指数**位宽）： 5 bits
- **Significand** precision（**尾数**精度）： 11 bits （有10位被显式存储）



要先理解3大要点：

* **小数的二进制表示法，即浮点数。**

* IEEE 754 浮点数如何在计算机中储存，即**符号位，指数位，小数位（通常翻译做尾数）**。
* **取值范围取决于指数位，计算精度取决于小数位（尾数）。**

* **小数位越多**（比如双精度是52位），则能表示的数越大，那么**计算精度则越高**。



**单精度**的小数位在计算机中只有23位（二进制），换算到十进制只能百分百保证6位十进制数字的精确度。

不能百分百保证7位的精度运算。

超过该精度（二进制23位，十进制6位）的小数运算将会被截取，造成**精度损失和计算结果的不准确**。

同理，**双精度**，小数位是52位（二进制），换算为十进制则只能百分百能保证15位。



## 多精度 multiprecision

数字位数越高，或是**小数点后位数越多**，意味着科学家可以在更大范围内的数值内体现两个数值的变化。借此，科学家可以对最大的星系，或是最小的粒子进行**精确计算**。

但是，**计算精度越高，意味着所需的计算资源、数据传输和内存存储就越多。其成本也会更大，同时也会消耗更多的功率。**

由于**并非每个工作负载都需要高精度**，因此 AI 和 HPC 研究人员可以通过**混合或匹配不同级别的精度的方式进行运算，从而使效益最大化。**NVIDIA Tensor Core GPU 支持多精度和混合精度技术，能够让开发者**优化计算资源**并加快 AI 应用程序及其推理功能的训练。

**多精度计算意味着使用能够以不同精度进行计算的处理器**：

* 在**需要使用高精度进行计算的部分**使用**双精度**
* **在应用程序的其他部分**使用**半精度或单精度**算法。



## 混合精度/超精度 mixed-precision

**混合精度（也称为超精度）**计算则是在单个操作中使用不同的精度级别，从而在不牺牲精度的情况下实现计算效率。

在混合精度中，**计算从半精度值开始，以进行快速矩阵数学运算**。但是**随着数字的计算，机器会以更高的精度存储结果。**例如，如果将两个16位矩阵相乘，则结果为32位大小。

使用这种方法，在应用程序结束计算时，其累积得到结果，在准确度上可与使用双精度算法运算得到的结果相媲美。

这项技术**可以将传统的双精度应用程序加速多达25倍，同时减少了运行所需的内存、时间和功耗。**它可用于 AI 和模拟 HPC 工作负载。

随着混合精度算法在现代超级计算应用程序中的普及，HPC 专家 Jack Dongarra 提出了一个新的基准，即 HPL-AI，以评估超级计算机在混合精度计算上的性能。当 NVIDIA 在全球最快的超级计算机 Summit 上运行 HPL-AI 计算时，该系统达到了前所未有的性能水平，接近550 petaflop，比其在 TOP500 榜单上的官方性能快了3倍。

混合精度是指训练时在模型中同时使用 16 位和 32 位浮点类型，从而**加快运行速度，减少内存使用**的一种训练方法。



## 有效位

英语名：	significant bit
定义：	确定一个数据的精度的那些数位。
见载：	计算机科学技术名词
学科：	计算机科学技术_计算机体系结构_计算机模型
公布年度：	2018

IEEE 浮点算术标准是用来衡量计算机上以二进制所表示数字精度的通用约定。在双精度格式中，每个数字占用64位，单精度格式占用32位，而半精度仅16位。

要了解其中工作原理，我们可以拿圆周率举例。在传统科学记数法中，圆周率表示为3.14 x100。但是计算机将这些信息以二进制形式存储为浮点，即一系列的1和0，它们代表一个数字及其对应的指数，在这种情况下圆周率则表示为1.1001001 x 21。

在单精度32位格式中，1位用于指示数字为正数还是负数。指数保留了8位，这是因为它为二进制，将2进到高位。其余23位用于表示组成该数字的数字，称为有效数字。

而在双精度下，指数保留11位，有效位数为52位，从而极大地扩展了它可以表示的数字范围和大小。半精度则是表示范围更小，其指数只有5位，有效位数只有10位。



