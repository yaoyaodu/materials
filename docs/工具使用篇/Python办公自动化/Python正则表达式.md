# 正则表达式（特殊的字符序列）（re模块）

正则表达式是一个**特殊的字符序列**，它能帮助你方便的**检查一个字符串是否与某种模式匹配**。

Python 自1.5版本起增加了**re 模块**，它提供 **Perl 风格的正则表达式模式**。

**re 模块使 Python 语言拥有全部的正则表达式功能。**

**compile 函数**根据一个模式字符串和可选的标志参数生成一个正则表达式对象。该对象拥有一系列方法用于正则表达式匹配和替换。

re 模块也提供了与这些方法功能完全一致的函数，这些函数使用一个模式字符串做为它们的第一个参数。

本章节主要介绍Python中常用的**正则表达式处理函数**。

### re.match函数

re.match 尝试从**字符串的起始位置**匹配一个模式，如果不是起始位置匹配成功的话，match() 就返回 none。

**函数语法**：

```
re.match(pattern, string, flags=0)
```

函数参数说明：

| 参数    | 描述                                                         |
| :------ | :----------------------------------------------------------- |
| pattern | 匹配的正则表达式。正则中的模式字符串。                       |
| string  | 要匹配的字符串。要被查找替换的原始字符串。                   |
| flags   | **标志位，用于控制正则表达式的匹配方式**，如：是否区分大小写，多行匹配等等。参见：[正则表达式修饰符 - 可选标志](https://www.runoob.com/python/python-reg-expressions.html#flags) |

匹配成功 re.match 方法返回一个匹配的对象，否则返回 None。

我们可以使用 group(num) 或 groups() 匹配对象函数来获取匹配表达式。

| 匹配对象方法 | 描述                                                         |
| :----------- | :----------------------------------------------------------- |
| group(num=0) | 匹配的整个表达式的字符串，group() 可以一次输入多个组号，在这种情况下它将返回一个包含那些组所对应值的元组。 |
| groups()     | 返回一个包含所有小组字符串的元组，从 1 到 所含的小组号。     |

#### 实例

```python
#!/usr/bin/python
# -*- coding: UTF-8 -*- 
 
import re
print(re.match('www', 'www.runoob.com').span())  # 在起始位置匹配
print(re.match('com', 'www.runoob.com'))         # 不在起始位置匹配
```



### 正则表达式模式

**模式字符串**使用**特殊的语法**来表示一个正则表达式：

* **字母和数字表示他们自身**。一个正则表达式模式中的字母和数字匹配同样的字符串。

* 多数**字母和数字前加一个反斜杠**时会拥有不同的含义。

* **标点符号只有被转义时才匹配自身**，否则它们表示特殊的含义。

* **反斜杠本身需要使用反斜杠转义**。

* 由于正则表达式通常都包含反斜杠，所以你最好使用原始字符串来表示它们。模式元素(如 r'\t'，等价于 '\\t')匹配相应的特殊字符。

下表列出了正则表达式模式语法中的**特殊元素**。如果你使用模式的同时提供了**可选的标志参数**，某些模式元素的含义会改变。

| 模式   | 描述                                                    |
| :----- | :------------------------------------------------------ |
| ^      | 匹配字符串的开头                                        |
| $      | 匹配字符串的末尾。                                      |
| [...]  | 用来表示一组字符,单独列出：[amk] 匹配 **'a'，'m'或'k'** |
| [^...] | 不在[]中的字符：`[^abc] `匹配**除了a,b,c之外的字符**。  |

#### 限定符(Quantifier)

| 模式   | 描述           |
| :----- | :------------- |
| a*     | a出现0次或多次 |
| a+     | a出现1次或多次 |
| a?     | a出现0次或1次  |
| a{6}   | a出现6次       |
| a{2,6} | a出现2到6次    |
| a{2,}  | a出现2次以上   |

#### 或运算符(OR Operator)

| 模式       | 描述         |
| :--------- | :----------- |
| (a\|b)     | 匹配a或者b   |
| (ab)\|(cd) | 匹配ab或者cd |

#### 字符类(Character Classes)

| 模式        | 描述                       |
| :---------- | :------------------------- |
| [abc]       | 匹配a或者b或者c            |
| [a-c]       | 同上                       |
| [a-fA-F0-9] | 匹配小写+大写英文字符+数字 |
| [^0-9]      | 匹配非数字字符             |

#### 贪婪/懒惰匹配(Greedy/Lazy Match)

| 模式  | 描述                   |
| :---- | :--------------------- |
| <.+>  | 默认贪婪匹配“任意字符” |
| <.+?> | 懒惰匹配“任意字符”     |



### 正则表达式实例

#### 字符匹配

| 实例   | 描述           |
| :----- | :------------- |
| python | 匹配 "python". |

#### 字符类

| 实例        | 描述                                  |
| :---------- | :------------------------------------ |
| [Pp]ython   | 匹配 "Python" **或** "python"         |
| rub[ye]     | 匹配 "ruby" **或** "rube"             |
| [aeiou]     | **匹配中括号内的任意一个字母**        |
| [0-9]       | **匹配任何数字**。类似于 [0123456789] |
| [a-z]       | 匹配任何小写字母                      |
| [A-Z]       | 匹配任何大写字母                      |
| [a-zA-Z0-9] | **匹配任何字母及数字**                |
| [^aeiou]    | 除了aeiou字母以外的所有字符           |
| [^0-9]      | **匹配除了数字外的字符**              |

#### 特殊字符类(d（数字字符）、s（空白字符）、w（[A-Za-z0-9_]）、b（单词边界）)

| 实例 | 描述                                                         |
| :--- | :----------------------------------------------------------- |
| .    | 匹配除换行符（ "\n" ）之外的任何**单个字符**。要匹配包括 '\n' 在内的任何字符，请使用象 '[.\n]' 的模式。 |
| \b   | 匹配一个单词边界，也就是指**单词和空格间的位置**。例如， 'er\b' 可以匹配"never" 中的 'er'，但不能匹配 "verb" 中的 'er'。 |
| \B   | 匹配非单词边界。'er\B' 能匹配 "verb" 中的 'er'，但不能匹配 "never" 中的 'er'。 |
| \d   | 匹配**一个**数字字符。等价于 [0-9]。                         |
| \D   | 匹配**一个**非数字字符。等价于 `[^0-9]`。                    |
| \s   | 匹配任何空白字符，包括**空格、制表符、换页符**等等。等价于 [ \f\n\r\t\v]。 |
| \S   | 匹配任何非空白字符。等价于` [^ \f\n\r\t\v]`。                |
| \w   | 匹配包括下划线的任何单词字符。等价于'[A-Za-z0-9_]'。**字母、数字、下划线。** |
| \W   | 匹配任何非单词字符。等价于` [^A-Za-z0-9_]`。                 |

正则表达式：

```
r'(.*) are (.*?) .*'
```

解析:

首先，这是一个字符串，前面的一个 **r** 表示字符串为非转义的原始字符串，让编译器忽略反斜杠，也就是忽略转义字符。但是这个字符串里没有反斜杠，所以这个 **r** 可有可无。

-  **(.\*)** 第一个匹配分组，.***** 代表匹配除换行符之外的所有字符。
-  **(.\*?)** 第二个匹配分组，**.\*?** 后面多个问号，代表**非贪婪模式**，也就是说**只匹配符合条件的最少字符**
-  后面的一个 **.\*** 没有括号包围，所以不是分组，匹配效果和第一个一样，但是不计入匹配结果中。

## 正则表达式（B站视频：孙兴华讲《正则表达式》）

正则表达式(Regular Expression)是一组由字母和符号组成的特殊文本，它可以用来从文本中找出满足你想要的格式的句子。

用户名规则限制：

* 只能包含小写字母、数字、下划线和连字符。
* 限制用户名长度在3~15个字符之间。

正则表达式：`^[a-z0-9_-]{3,15}$`













